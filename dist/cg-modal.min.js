(()=>{"use strict";function t(o){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(o)}function o(t,o){(null==o||o>t.length)&&(o=t.length);for(var e=0,n=new Array(o);e<o;e++)n[e]=t[e];return n}function e(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function n(t){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,n),this._activeClass="active",this.modals=null,this.documentBody=document.body,this.options=this.deepMerge({selector:".modal",openButtonSelector:"[data-open-modal]",closeButtonSelector:".modal__close-btn",contentClass:"modal__content",wrapperClass:"modal__wrapper",effect:null,speed:300,position:"center",addTechClasses:!0,on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){},openBtnClick:function(){},update:function(){}}},t),this.init()}var c,s;return c=n,(s=[{key:"init",value:function(){var t=this;this.modals=document.querySelectorAll("".concat(this.options.selector)),this.modals?(this.modals.forEach((function(o){t.hasEffect(t.options.effect)&&o.classList.add("".concat(t.options.effect)),!0===t.options.addTechClasses&&(!o.classList.contains("cg-modal")&&o.classList.add("cg-modal"),!o.querySelector(".".concat(t.options.wrapperClass)).classList.contains("cg-modal-wrapper")&&o.querySelector(".".concat(t.options.wrapperClass)).classList.add("cg-modal-wrapper")),o.classList.add("".concat(t.options.position)),t.options.speed&&t._isNumeric(t.options.speed)&&o.style.setProperty("--speed",parseFloat(t.options.speed/1e3)+"s")})),this._eventsHandler()):console.error('Не найден элемент с селектором "'.concat(this.options.selector,'"'))}},{key:"_eventsHandler",value:function(){var t=this,o=document.querySelectorAll("".concat(this.options.openButtonSelector));o?o.forEach((function(o){o.addEventListener("click",(function(o){t.options.on.openBtnClick.call(t),o.stopPropagation(),t.open("".concat(o.currentTarget.dataset.openModal))}))})):console.error('Не найден элемент с селектором "'.concat(this.options.openButtonSelector,'"')),this.modals.forEach((function(o){var e=o.querySelectorAll("".concat(t.options.closeButtonSelector));e&&e.forEach((function(e){e.addEventListener("click",(function(e){e.stopPropagation(),t.close(o)}))}));var n=o.querySelector(".".concat(t.options.contentClass));n?(!0===t.options.addTechClasses&&!n.classList.contains("cg-modal-content")&&n.classList.add("cg-modal-content"),n.addEventListener("click",(function(t){t.stopPropagation()}))):console.error('Не найден элемент ".'.concat(t.options.contentClass,'"'))})),this.documentBody.addEventListener("click",(function(){!1!==t.hasActiveModal()&&t.closeActive()})),document.onkeydown=function(o){!1!==t.hasActiveModal()&&27==(o=o||window.event).keyCode&&t.closeActive()}}},{key:"open",value:function(t){this.options.on.beforeOpen.call(this);var o=document.querySelector("[data-modal=".concat(t,"]"));o?(o.classList.add("".concat(this._activeClass)),this.documentBody.style.overflow="hidden",this.options.on.afterOpen.call(this)):console.error("Не найдено соответствующее окно с атрибутом равным ".concat(t))}},{key:"close",value:function(t){this.options.on.beforeClose.call(this),t.classList.remove("".concat(this._activeClass)),this.documentBody.style.overflow="",this.options.on.afterClose.call(this)}},{key:"closeActive",value:function(){var t=this.hasActiveModal();!1!==t&&this.close(t)}},{key:"hasActiveModal",value:function(){return!!document.querySelector("".concat(this.options.selector,".").concat(this._activeClass))&&document.querySelector("".concat(this.options.selector,".").concat(this._activeClass))}},{key:"_isNumeric",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"deepMerge",value:function(e,n){var c=this;return n?(Object.entries(n).forEach((function(n){var s,r,a=(r=2,function(t){if(Array.isArray(t))return t}(s=n)||function(t,o){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,c,s=[],r=!0,a=!1;try{for(e=e.call(t);!(r=(n=e.next()).done)&&(s.push(n.value),!o||s.length!==o);r=!0);}catch(t){a=!0,c=t}finally{try{r||null==e.return||e.return()}finally{if(a)throw c}}return s}}(s,r)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(s,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],l=a[1];l&&"object"===t(l)?c.deepMerge(e[i]=e[i]||{},l):e[i]=l})),e):e}},{key:"hasEffect",value:function(t){return!(!t||-1==["fade","transformLeft","transformRight","transformTop","transformBottom","scaleCenter"].indexOf(t.toString().trim()))}},{key:"update",value:function(){this.init(),this.options.on.update.call(this)}}])&&e(c.prototype,s),Object.defineProperty(c,"prototype",{writable:!1}),n}();window.CgModal=n})();